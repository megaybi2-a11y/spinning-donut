<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ASCII Donut</title>

<style>
  body {
    margin: 0;
    background: black;
    color: #00ff99;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden;
    font-family: monospace;
  }

  pre {
    white-space: pre;
    font-size: clamp(6px, 1.8vw, 14px);
    line-height: 1;
    user-select: none;
  }
</style>
</head>
<body>

<pre id="donut"></pre>

<script>
const pre = document.getElementById("donut");

let A = 0, B = 0;

const width = 80;
const height = 22;
const size = width * height;
const chars = ".,-~:;=!*#$@";

function render() {
  const buffer = new Array(size).fill(" ");
  const z = new Array(size).fill(0);

  A += 0.04;
  B += 0.02;

  const cA = Math.cos(A), sA = Math.sin(A);
  const cB = Math.cos(B), sB = Math.sin(B);

  for (let theta = 0; theta < 6.28; theta += 0.07) {
    const ct = Math.cos(theta);
    const st = Math.sin(theta);

    for (let phi = 0; phi < 6.28; phi += 0.02) {
      const sp = Math.sin(phi);
      const cp = Math.cos(phi);

      const h = ct + 2;
      const D = 1 / (sp * h * sA + st * cA + 5);
      const t = sp * h * cA - st * sA;

      const x = Math.floor(width / 2 + 30 * D * (cp * h * cB - t * sB));
      const y = Math.floor(height / 2 + 15 * D * (cp * h * sB + t * cB));

      const o = x + width * y;

      const N = Math.floor(
        8 * (
          (st * sA - sp * ct * cA) * cB -
          sp * ct * sA -
          st * cA -
          cp * ct * sB
        )
      );

      if (
        y >= 0 &&
        y < height &&
        x >= 0 &&
        x < width &&
        D > z[o]
      ) {
        z[o] = D;
        buffer[o] = chars[Math.max(N, 0)];
      }
    }
  }

  let output = "";
  for (let i = 0; i < size; i++) {
    output += buffer[i];
    if ((i + 1) % width === 0) output += "\n";
  }

  pre.textContent = output;
}

setInterval(render, 50);
</script>

</body>
</html>
